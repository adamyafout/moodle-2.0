define ("assignsubmission_cloudpoodll/submissionhelper",["jquery","core/log","assignsubmission_cloudpoodll/cloudpoodllloader","core/str"],function(a,b,c,d){"use strict";b.debug("submission helper: initialising");return{uploadstate:!1,togglestate:0,strings:{},init:function init(a){this.component=a.component;this.safesave=a.safesave;this.register_controls();this.register_events();this.setup_recorder()},setup_recorder:function setup_recorder(){var a=this;c.init(this.component+"_therecorder",function recorder_callback(b){switch(b.type){case"recording":if("started"===b.action){a.controls.updatecontrol.val();if(1==a.safesave){a.controls.formsubmitbutton.attr("disabled","disabled")}}break;case"awaitingprocessing":if("posted"!=a.uploadstate){a.controls.updatecontrol.val(b.mediaurl);if(1==a.safesave){a.controls.formsubmitbutton.removeAttr("disabled","disabled")}}a.uploadstate="posted";break;case"error":alert("PROBLEM:"+b.message);break;}})},register_controls:function register_controls(){var b=this;this.controls={};this.controls.formsubmitbutton=a("#id_submitbutton");this.controls.deletebutton=a("."+this.component+"_deletesubmissionbutton");this.controls.updatecontrol=a("#"+this.component+"_updatecontrol");this.controls.currentcontainer=a("."+this.component+"_currentsubmission");this.controls.togglecontainer=a("."+this.component+"_togglecontainer");this.controls.togglebutton=a("."+this.component+"_togglecontainer .togglebutton");this.controls.toggletext=a("."+this.component+"_togglecontainer .toggletext");d.get_string("clicktohide",b.component).done(function(a){b.strings.clicktohide=a});d.get_string("clicktoshow",b.component).done(function(a){b.strings.clicktoshow=a})},register_events:function register_events(){var a=this;this.controls.deletebutton.click(function(){if(a.controls.updatecontrol){if(confirm(M.util.get_string("reallydeletesubmission",a.component))){a.controls.updatecontrol.val(-1);a.controls.currentcontainer.html("")}}});this.controls.togglebutton.click(function(){a.toggle_currentsubmission(a)});this.controls.toggletext.click(function(){a.toggle_currentsubmission(a)})},toggle_currentsubmission:function toggle_currentsubmission(a){a.controls.currentcontainer.toggle({duration:300,complete:function doToggleState(){if(0==a.togglestate){a.controls.togglebutton.removeClass("fa-toggle-off");a.controls.togglebutton.addClass("fa-toggle-on");a.controls.toggletext.text(a.strings.clicktohide);a.togglestate=1}else{a.controls.togglebutton.removeClass("fa-toggle-on");a.controls.togglebutton.addClass("fa-toggle-off");a.controls.toggletext.text(a.strings.clicktoshow);a.togglestate=0}}});return!1}}});
//# sourceMappingURL=submissionhelper.min.js.map
